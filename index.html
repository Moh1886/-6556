<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>📚 نظام إدارة الدراسة</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { direction: rtl; text-align: right; }
    .nav-link { font-weight: bold; }
  </style>
</head>
<body class="bg-light">

<div class="container mt-4">
  <h1 class="text-center text-primary mb-4">📚 نظام إدارة الدراسة</h1>

  <!-- شريط تنقل -->
  <ul class="nav nav-tabs mb-4" id="myTabs">
    <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#home">🏠 الرئيسية</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#schedule">📅 جدول الحصص</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#lessons">📖 الدروس</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tasks">📝 المهام</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#homework">📂 الواجب</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#exams">📑 الامتحانات</a></li>
  </ul>

  <div class="tab-content">

    <!-- 🏠 الرئيسية -->
    <div class="tab-pane fade show active" id="home">
      <div class="alert alert-info text-center">اختر القسم من القائمة بالأعلى ⬆️</div>

      <!-- 🔔 التنبيهات -->
      <div class="card shadow-sm mt-4">
        <div class="card-header bg-warning text-dark fw-bold">
          🔔 التنبيهات
        </div>
        <ul class="list-group list-group-flush">
          {% if notifications %}
            {% for note in notifications %}
              <li class="list-group-item">
                <span class="fw-bold">{{ note.subject }}</span> – {{ note.details }}
                <br>
                <small class="text-muted">📅 {{ note.date }} ⏰ {{ note.time }}</small>
              </li>
            {% endfor %}
          {% else %}
            <li class="list-group-item text-muted text-center">لا توجد تنبيهات حالياً ✅</li>
          {% endif %}
        </ul>
      </div>
    </div>

    <!-- 📅 جدول الحصص -->
    <div class="tab-pane fade" id="schedule">
      <h3 class="mb-3">📅 جدول الحصص</h3>
      <form method="POST" action="/schedule" class="card p-3 mb-4 shadow-sm">
        <div class="row g-2">
          <div class="col-md-4">
            <label class="form-label">اليوم</label>
            <select name="day" class="form-control" required>
              <option>الأحد</option><option>الاثنين</option><option>الثلاثاء</option>
              <option>الأربعاء</option><option>الخميس</option>
            </select>
          </div>
          <div class="col-md-8">
            {% for i in range(1,9) %}
              <label class="form-label">الحصة {{ i }}</label>
              <input type="text" name="p{{i}}" class="form-control mb-2">
            {% endfor %}
          </div>
        </div>
        <button type="submit" class="btn btn-success mt-3">💾 حفظ</button>
      </form>

      <table class="table table-bordered text-center">
        <thead class="table-primary">
          <tr>
            <th>اليوم</th>
            {% for i in range(1,9) %}<th>الحصة {{i}}</th>{% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for day, subjects in table.items() %}
          <tr>
            <td>{{ day }}</td>
            {% for subject in subjects %}
              <td>{{ subject }}</td>
            {% endfor %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- 📖 الدروس -->
    <div class="tab-pane fade" id="lessons">
      <h3 class="mb-3">📖 الدروس</h3>
      <form method="POST" action="/lessons" class="card p-3 mb-3">
        <div class="row g-2">
          <div class="col-md-4">
            <label class="form-label">اليوم</label>
            <select name="day" class="form-control">
              <option>الأحد</option><option>الاثنين</option><option>الثلاثاء</option>
              <option>الأربعاء</option><option>الخميس</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">المادة</label>
            <input type="text" name="subject" class="form-control">
          </div>
          <div class="col-md-2 d-flex align-items-end">
            <button type="submit" class="btn btn-success w-100">➕ إضافة</button>
          </div>
        </div>
      </form>

      <table class="table table-bordered">
        <thead class="table-primary"><tr><th>اليوم</th><th>المادة</th></tr></thead>
        <tbody>
          {% for lesson in lessons %}
          <tr><td>{{ lesson[1] }}</td><td>{{ lesson[2] }}</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- 📝 المهام -->
    <div class="tab-pane fade" id="tasks">
      <h3 class="mb-3">📝 المهام</h3>
      <form method="POST" action="/tasks" class="card p-3 mb-3">
        <div class="row g-2">
          <div class="col-md-4"><input type="text" name="subject" class="form-control" placeholder="المادة"></div>
          <div class="col-md-6"><input type="text" name="description" class="form-control" placeholder="الوصف"></div>
          <div class="col-md-2"><button class="btn btn-success w-100">إضافة</button></div>
        </div>
      </form>
      <ul class="list-group">
        {% for task in tasks %}
        <li class="list-group-item">{{ task[1] }} - {{ task[2] }}</li>
        {% endfor %}
      </ul>
    </div>

    <!-- 📂 الواجب -->
    <div class="tab-pane fade" id="homework">
      <h3 class="mb-3">📂 الواجب</h3>
      <form method="POST" action="/homework" enctype="multipart/form-data" class="card p-3 mb-3">
        <input type="text" name="subject" class="form-control mb-2" placeholder="المادة">
        <input type="text" name="details" class="form-control mb-2" placeholder="التفاصيل">
        <input type="file" name="image" class="form-control mb-2">
        <button class="btn btn-success">رفع</button>
      </form>
      <ul class="list-group">
        {% for hw in homework %}
        <li class="list-group-item">
          {{ hw[1] }} - {{ hw[2] }}
          {% if hw[3] %}<br><img src="/uploads/{{ hw[3] }}" width="100">{% endif %}
        </li>
        {% endfor %}
      </ul>
    </div>

    <!-- 📑 الامتحانات -->
    <div class="tab-pane fade" id="exams">
      <h3 class="mb-3">📑 الامتحانات</h3>
      <form method="POST" action="/exams" class="card p-3 mb-3">
        <input type="text" name="subject" class="form-control mb-2" placeholder="المادة">
        <input type="date" name="date" class="form-control mb-2">
        <input type="text" name="details" class="form-control mb-2" placeholder="تفاصيل">
        <button class="btn btn-success">إضافة</button>
      </form>
      <ul class="list-group">
        {% for exam in exams %}
        <li class="list-group-item">{{ exam[1] }} - {{ exam[2] }} - {{ exam[3] }}</li>
        {% endfor %}
      </ul>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
